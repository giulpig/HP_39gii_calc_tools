EXPORT ROOT_LOCUS(numer,denom,magn,prec)
BEGIN

  LOCAL X,Y,TEMP,COUNT,CCOUNT,MIDDLEX,MIDDLEY,MAGN;
  LOCAL SUM,N,S,NI,PREC;
  PREC:=prec;
  MAGN:=magn;
  MIDDLEX:=127;
  MIDDLEY:=62;
  NUMER:=numer;
  DENOM:=denom;
  SUM=0;

  RECT();

  PIXON_P(255,126);

  M3:=POLYROOT(NUMER);
  M4:=POLYROOT(DENOM);

  LINE_P(MIDDLEX,0,MIDDLEX,126,2);
  LINE_P(0,MIDDLEY,255,MIDDLEY,2);

  L1:=SIZE(M3);
  TEMP:=L1(1);
  //FOR COUNT FROM 1 TO TEMP STEP 1 DO
  //  X:=FLOOR(RE(M3(COUNT))*MAGN+MIDDLEX);
  //  Y:=FLOOR(IM(M3(COUNT))*MAGN+MIDDLEY);
  //  PIXON_P(X,Y);
  //  FOR CCOUNT FROM 1 TO 2 STEP 1 DO
  //    PIXON_P(X+CCOUNT, Y+CCOUNT);
  //    PIXON_P(X+CCOUNT, Y-CCOUNT);
  //    PIXON_P(X-CCOUNT, Y+CCOUNT);
  //    PIXON_P(X-CCOUNT, Y-CCOUNT);
  //  END;
  //END;

  L2:=SIZE(M4);
  //TEMP:=L2(1);
  //FOR COUNT FROM 1 TO TEMP STEP 1 DO
  //  X:=FLOOR(RE(M4(COUNT))*MAGN+MIDDLEX);
  //  Y:=FLOOR(IM(M4(COUNT))*MAGN+MIDDLEY);
  //  ARC_P(X,Y,2);
  //END;

  FOR COUNT FROM 0 TO 255 DO
    FOR CCOUNT FROM 0 TO 126 DO
      //PIXON_P(COUNT,CCOUNT);
      X:=FLOOR(((COUNT-MIDDLEX)/MAGN));
      Y:=FLOOR(((CCOUNT-MIDDLEY)/MAGN));
      TEMP:=L1(1);
      FOR N FROM 1 TO TEMP DO
        SUM:=SUM+ARG(X+Y*i-M3(N));
      END;
     TEMP:=L2(1);
      FOR N FROM 1 TO TEMP DO
        SUM:=SUM-ARG(X+Y*i-M4(N));
      END;
      SUM:=SUM/p;
      IF (FRAC(SUM) < prec AND (ROUND(SUM,0) MOD 2) == 1 THEN
        PIXON(COUNT,CCOUNT);
      END;
    END;
  END;

  WAIT(0);

END;
