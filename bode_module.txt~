EXPORT BODE_MOD(a,b,c,d,f)
BEGIN
  LOCAL MIDDLEX,MIDDLEY,NUMER,DENOM,MAGN,RES,PREC,W;
  LOCAL MAXW;

  RECT();

  MIDDLEX:=127;
  MIDDLEY:=62;
  //NUMER:=a;
  //DENOM:=b;
  MAGN:=c;
  PREC:=d;
  MAXW:=f;

  NUMER:=[1,-1];
  DENOM:=[1,4,5];

  //Draw axis lines
  LINE_P(0,MIDDLEY,254,MIDDLEY,2);
  LINE_P(MIDDLEX,0,MIDDLEX,125,2);

  W:=PREC;
  WHILE W < MAXW DO
    RES:=POLYEVAL(DENOM, W*i);
    IF RES==0 THEN
      RES:=0;
    ELSE
      RES:=20*LOG(ABS(POLYEVAL(NUMER, W*i)/RES));
      PIXON_P(INT(MAGN*LOG(W)+MIDDLEX), INT(-RES+MIDDLEY));
      RES:=ARG(POLYEVAL(NUMER, W*i)/RES);
      PIXON_P(INT(MAGN*LOG(W)+MIDDLEX), INT(-RES+MIDDLEY));
    END;
    W:=W*(1+PREC);
  END;

  TEXTOUT_P("FINISHED",0,0,1);
  WAIT(0);

END;

